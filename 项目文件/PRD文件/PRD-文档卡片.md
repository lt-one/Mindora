 # PRD: 文档卡片模块

## 文档信息

- **文档名称**：PRD-文档卡片
- **版本号**：V1.0
- **更新日期**：2023-11-10
- **状态**：初稿
- **作者**：产品经理
- **审核人**：技术负责人

## 一、概述

文档卡片模块是MindBreak个人网站的一个实用工具功能，旨在提供一种简单、灵活的方式来记录灵感、计划、笔记和临时想法。类似于数字化的便利贴或卡片系统，用户可以快速创建、组织和查找各类短小精悍的内容片段。该功能既满足个人日常知识管理需求，同时展示了个人的思考方式和内容组织能力。

## 二、目标用户

1. **网站所有者**：需要记录临时想法和灵感的创作者
2. **研究者与学习者**：需要整理知识点和学习笔记的用户
3. **项目管理者**：需要组织任务和跟踪进度的管理者
4. **内容创作者**：需要收集创意和素材的写作者、设计师
5. **知识工作者**：需要构建知识体系的专业人士

## 三、用户目标

### 网站所有者

- 快速捕捉转瞬即逝的灵感和想法
- 组织和分类各种内容片段和资源
- 构建个性化的知识管理系统
- 追踪项目计划和进度

### 其他用户（如开放访问）

- 浏览分享的知识卡片和内容收藏
- 了解作者的思考方式和知识结构
- 获取特定领域的精选信息和资源

## 四、功能需求

### 1. 核心功能

#### 1.1 卡片创建与编辑

- 快速创建新卡片（标题、内容、标签）
- 富文本编辑支持（基础格式化、链接、列表）
- 支持插入图片和简单图表
- 自动保存和版本历史
- 简单的模板系统（空白、笔记、任务等）

#### 1.2 卡片组织与管理

- 自定义标签系统
- 支持创建卡片集合（Collection）
- 拖拽式界面布局
- 多种视图切换（网格视图、列表视图、看板视图）
- 基础归档和删除功能

#### 1.3 卡片检索与筛选

- 实时搜索（标题、内容、标签）
- 按创建日期、更新日期筛选
- 按标签、集合筛选
- 保存常用筛选条件

#### 1.4 卡片展示与共享

- 单卡片详情页面
- 卡片集合页面
- 选择性公开或私密设置
- 生成分享链接功能

### 2. 扩展功能

#### 2.1 高级编辑功能

- Markdown支持
- 代码块支持（带语法高亮）
- 简单绘图功能
- 嵌入外部内容（视频、音频、网页）

#### 2.2 关联与连接

- 卡片间交叉引用链接
- 卡片关系图谱可视化
- 自动相关卡片推荐

#### 2.3 协作功能

- 评论和反馈系统
- 基础协作编辑功能
- 版本比较和回滚

## 五、交互需求

### 1. 创建与编辑交互

- **快速创建**：
  - 全局快捷键/悬浮按钮创建新卡片
  - 快速输入标题和内容进行保存
  - 可选择模板或从头创建

- **编辑体验**：
  - 实时预览编辑内容
  - 简单的格式工具栏
  - 直观的图片拖拽上传
  - 自动保存编辑内容

### 2. 组织与检索交互

- **标签操作**：
  - 输入式标签添加
  - 点击标签切换筛选
  - 标签管理界面

- **视图切换**：
  - 简单的视图选择器
  - 记住用户偏好的视图设置

- **搜索体验**：
  - 即时搜索响应
  - 高亮显示匹配内容
  - 搜索建议和历史

### 3. 卡片交互行为

- **卡片操作**：
  - 悬停显示快捷操作菜单
  - 拖拽重排序和分组
  - 双击快速编辑

- **集合操作**：
  - 创建/编辑集合属性
  - 将卡片添加到多个集合
  - 集合之间的卡片移动

## 六、技术实现需求

### 1. 前端实现

- **技术栈**：
  - Next.js 14 混合渲染
  - React 客户端交互组件
  - Tailwind CSS 响应式设计
  - 状态管理使用React Context或Zustand

- **编辑器实现**：
  - 集成TipTap或Slate等富文本编辑器
  - 或使用Markdown-it等Markdown解析器

- **UI组件**：
  - 拖拽使用react-beautiful-dnd
  - 卡片布局使用CSS Grid或Flexbox
  - 响应式设计适配各种屏幕尺寸

### 2. 后端实现

- **数据存储**：
  - 使用Prisma ORM与数据库交互
  - 本地缓存策略提升性能

- **API设计**：
  - RESTful API或GraphQL接口
  - 实时更新使用Server Actions
  - 本地数据同步机制

- **性能考虑**：
  - 卡片内容按需加载
  - 大型集合的分页加载
  - 搜索索引优化

### 3. 存储策略

- **持久化存储**：
  - 数据库存储卡片内容和元数据
  - 图片使用对象存储服务

- **本地存储**：
  - 使用localStorage缓存最近编辑
  - 未同步内容的本地备份
  - 脱机编辑支持

## 七、数据需求

### 1. 数据模型：DocumentCard

```prisma
model DocumentCard {
  id          String      @id @default(cuid())
  title       String      // 卡片标题
  content     String      // 卡片内容（富文本或Markdown）
  format      String      @default("rich-text") // 内容格式："rich-text", "markdown", "plain-text"
  tags        String[]    // 标签数组
  isPublic    Boolean     @default(false) // 是否公开可见
  isPinned    Boolean     @default(false) // 是否置顶
  color       String?     // 卡片颜色
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  archivedAt  DateTime?   // 归档时间，null表示未归档
  collections Collection[] @relation("CardToCollection") // 所属集合
  assets      CardAsset[] // 关联资源（图片等）
  position    Int?        // 在当前视图中的位置
}

model Collection {
  id          String        @id @default(cuid())
  name        String        // 集合名称
  description String?       // 集合描述
  color       String?       // 集合颜色
  isPublic    Boolean       @default(false) // 是否公开可见
  cards       DocumentCard[] @relation("CardToCollection")
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

model CardAsset {
  id          String       @id @default(cuid())
  cardId      String       // 关联的卡片ID
  card        DocumentCard @relation(fields: [cardId], references: [id], onDelete: Cascade)
  type        String       // 资源类型: "image", "file", "link"
  url         String       // 资源URL
  title       String?      // 资源标题
  createdAt   DateTime     @default(now())
}
```

### 2. 数据流程

- **创建流程**：
  - 用户创建卡片时，生成唯一ID
  - 内容实时保存到本地存储
  - 定期同步到服务器数据库

- **编辑流程**：
  - 加载卡片时获取最新数据
  - 编辑变更实时保存到本地
  - 完成编辑后更新服务器端

- **查询流程**：
  - 标签和全文搜索使用索引
  - 集合查询通过关联表实现
  - 相关卡片推荐基于标签和内容分析

## 八、非功能需求

### 1. 性能需求

- 卡片创建响应时间小于0.5秒
- 编辑实时保存延迟小于1秒
- 搜索结果返回时间小于0.8秒
- 支持至少1000张卡片的流畅管理
- 单卡片支持最大内容量10MB

### 2. 可用性需求

- 简洁直观的操作界面
- 关键操作不超过3次点击
- 提供快捷键支持常用操作
- 移动端友好的触控操作
- 提供操作撤销/恢复功能

### 3. 可靠性需求

- 自动保存防止内容丢失
- 本地备份关键内容
- 同步冲突检测和解决机制
- 系统错误时的数据恢复能力

### 4. 安全需求

- 私密卡片的访问控制
- 内容数据的加密存储
- 防止XSS和注入攻击
- 敏感信息过滤和保护

## 九、设计规范

### 1. 视觉设计

- **卡片样式**：
  - 简洁的卡片设计，轻微阴影
  - 可自定义卡片背景色
  - 内容层次清晰的排版
  - 标签使用小标签形式展示

- **布局设计**：
  - 响应式网格布局
  - 移动端适配为单列流式布局
  - 桌面端支持多列自适应布局
  - 空白状态友好提示

- **交互反馈**：
  - 卡片操作的动画过渡效果
  - 拖拽时的视觉反馈
  - 状态变化的微妙动效

### 2. 内容规范

- **卡片结构**：
  - 标题：简洁明了，限制字数
  - 内容：支持段落、列表、链接等
  - 底部：显示标签、创建时间等元信息

- **模板设计**：
  - 笔记模板：标题+正文结构
  - 任务模板：包含清单和状态
  - 资源模板：链接+描述结构
  - 想法模板：简洁的灵感记录格式

## 十、验收标准

### 1. 功能验收

- 核心功能全部实现并可用
- 卡片CRUD操作流畅无错误
- 标签系统正常工作
- 搜索结果准确且响应及时
- 视图切换正常并保存用户设置

### 2. 性能验收

- 满足各项性能需求指标
- 大量卡片下仍保持良好响应
- 图片和媒体内容加载优化
- 编辑操作无明显延迟

### 3. 可用性验收

- 用户测试反馈积极
- 关键功能易于发现和使用
- 移动端体验良好
- 无明显的使用障碍

### 4. 兼容性验收

- 主流浏览器兼容性测试通过
- 不同设备和屏幕尺寸适配良好
- 键盘和触控操作均可用

## 十一、上线计划

### 1. 阶段发布

- **阶段一**：基础卡片功能（创建、编辑、标签）
- **阶段二**：组织功能（集合、视图切换）
- **阶段三**：高级功能（Markdown、关联、分享）
- **阶段四**：协作和扩展功能

### 2. 迭代计划

- 每两周一个小功能迭代
- 每两个月一个主要功能集合发布
- 根据用户反馈调整优先级

## 十二、附录

### 1. 用户故事

**故事1：快速记录想法**
作为一名内容创作者，我想要能够快速记录突然出现的灵感和想法，以便于日后查找和扩展这些创意。

**故事2：管理学习笔记**
作为一名学习者，我想要整理和分类不同主题的学习笔记，以便于复习和构建知识体系。

**故事3：项目规划管理**
作为一名项目负责人，我想要使用卡片方式来规划项目步骤和任务，以便于直观地管理项目进度。

### 2. 界面原型参考

[附上线框图或设计图链接]

### 3. 竞品分析

- **Notion**：多功能工作区，支持各种内容块
- **Trello**：看板式任务管理
- **Google Keep**：简洁的笔记卡片
- **Evernote**：功能丰富的笔记应用
- **Roam Research**：双向链接笔记系统