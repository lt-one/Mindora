# PRD: 博客系统模块

## 1. 文档信息

- **文档名称**：MindBreak个人网站博客系统PRD
- **版本号**：V1.1
- **更新日期**：2023-11-20
- **状态**：进行中

## 2. 概述

博客系统模块是MindBreak个人网站的核心内容输出平台，旨在以结构化、专业化的方式展示个人的技术文章、学习笔记、项目分析和行业见解。该模块不仅是知识分享的窗口，也是展示专业能力和思考深度的重要渠道。系统支持多种内容格式、分类管理、标签检索以及互动功能，为读者提供高质量的阅读体验，同时为网站所有者建立个人品牌和专业影响力。

## 3. 目标用户

- **技术同行**：寻找专业技术文章、解决方案和最佳实践
- **潜在雇主**：了解候选人的技术深度、专业领域和表达能力
- **学习者**：获取教程、学习资源和知识分享
- **项目合作者**：了解技术理念和专业方向，评估合作可能性
- **个人**：记录和展示自己的技术成长轨迹和思考过程

## 4. 用户目标

### 读者目标
1. 快速找到感兴趣的技术文章和主题
2. 获取高质量、深度的技术内容和解决方案
3. 轻松浏览和阅读，享受良好的阅读体验
4. 与作者交流互动，提出问题或分享见解
5. 保存或分享有价值的文章内容

### 作者（站点所有者）目标
1. 系统化展示个人技术积累和思考
2. 建立专业领域的影响力和个人品牌
3. 获取读者反馈，促进专业交流和成长
4. 灵活管理和组织博客内容
5. 跟踪文章表现和读者互动数据

## 5. 功能需求

### 5.1 页面结构

#### 5.1.1 博客首页

**功能描述**：展示博客文章的概览，支持分类浏览和筛选

**详细需求**：
- 文章以卡片或列表形式展示，包含标题、摘要、发布日期、分类、标签和封面图
- 支持文章置顶功能，重要文章可固定在顶部
- 提供文章分类、标签筛选和搜索功能
- 支持按发布时间、阅读量或推荐度排序
- 实现无限滚动或分页加载
- 展示博客统计信息（文章总数、分类数等）

**页面元素**：
- 博客头部：标题、简介和作者简要信息
- 导航区：分类导航、标签云、搜索框
- 文章列表区：文章卡片或列表视图
- 侧边栏：热门文章、最新文章、推荐阅读
- 页脚：分页控件或加载更多按钮

#### 5.1.2 文章详情页

**功能描述**：展示单篇博客文章的完整内容，提供阅读和互动功能

**详细需求**：
- 文章标题、元数据（作者、发布日期、更新日期、阅读时间）
- 格式丰富的文章正文，支持Markdown渲染
- 文章目录/大纲，支持锚点导航
- 代码块语法高亮和复制功能
- 相关文章推荐
- 分享功能：支持分享到社交媒体
- 评论区：支持读者留言和讨论
- 作者信息区：展示作者简介和联系方式

**页面元素**：
- 文章头部：标题、元数据、封面图
- 文章正文：格式化内容、图片、代码块
- 侧边导航：文章目录、阅读进度指示器
- 文章尾部：标签、版权信息、分享按钮
- 相关推荐：相关文章卡片
- 评论区：评论列表和评论表单
- 返回顶部：长文章的快速导航按钮

#### 5.1.3 分类/标签页

**功能描述**：展示特定分类或标签下的文章集合

**详细需求**：
- 分类/标签头部，包含名称、描述和文章数量
- 当前分类/标签下的文章列表
- 支持在当前分类下进一步筛选
- 分类层次结构展示（如果有子分类）

**页面元素**：
- 分类/标签标题和描述区
- 子分类导航（如适用）
- 筛选选项区
- 文章列表区
- 分页控件

#### 5.1.4 归档页

**功能描述**：按时间线展示所有博客文章

**详细需求**：
- 按年月组织文章，支持时间线视图
- 提供简洁的文章概览，包含标题和日期
- 支持按年份或月份快速筛选
- 显示每个时间段的文章数量

**页面元素**：
- 时间轴导航：年份和月份快速跳转
- 按时间分组的文章列表
- 时间指示器：年月标记
- 文章计数器：各时间段的文章数量

### 5.2 交互需求

#### 5.2.1 导航与浏览交互

- **分类导航**：点击分类自动筛选相关文章
- **标签交互**：点击标签显示相关文章，支持标签组合筛选
- **搜索交互**：实时搜索建议，输入关键词后显示匹配结果
- **排序交互**：切换不同排序方式，实时更新文章列表
- **分页/加载**：滚动到底部自动加载更多或点击分页按钮
- **阅读进度**：文章页显示阅读进度指示器，随滚动更新

#### 5.2.2 文章阅读交互

- **目录导航**：点击目录项自动滚动到对应章节
- **代码块**：支持代码语法高亮，提供复制按钮
- **图片查看**：点击图片可放大查看，支持图片画廊浏览
- **外部链接**：自动在新标签页打开外部链接
- **内部链接**：平滑跳转到站内其他文章
- **返回顶部**：长文章提供返回顶部按钮，点击平滑滚动

#### 5.2.3 互动功能交互

- **评论提交**：评论表单验证，提交后实时显示
- **评论回复**：支持多层嵌套回复，清晰的视觉层次
- **点赞/收藏**：文章点赞和收藏功能，状态实时更新
- **分享功能**：一键分享到社交媒体，生成分享链接
- **订阅更新**：提供RSS订阅或邮件通知功能

#### 5.2.4 响应式交互

- **移动端菜单**：小屏幕下的折叠菜单和导航抽屉
- **阅读模式**：提供专注阅读模式，隐藏非核心元素
- **字体调整**：允许读者调整字体大小和行间距
- **暗色模式**：支持明暗主题切换，保护夜间阅读体验

### 5.3 技术实现需求

#### 5.3.1 前端实现

- **框架选择**：使用Next.js实现，支持静态生成和服务端渲染
- **Markdown渲染**：使用MDX或Markdown-it处理Markdown内容
- **语法高亮**：使用Prism.js或Highlight.js实现代码高亮
- **响应式设计**：使用Tailwind CSS实现完全响应式布局
- **状态管理**：使用React Context或Redux管理全局状态
- **客户端路由**：优化页面间导航体验，实现平滑过渡
- **SEO优化**：每篇文章生成适当的元标签和结构化数据

#### 5.3.2 内容管理

- **文章存储**：使用Markdown文件存储文章内容，支持Git版本控制
- **元数据管理**：使用frontmatter格式定义文章元数据
- **图片资源**：优化图片存储和加载策略，支持响应式图片
- **草稿功能**：支持草稿模式，预览未发布内容
- **版本控制**：通过Git历史跟踪文章修改记录

#### 5.3.3 性能优化

- **静态生成**：使用Next.js的静态生成功能预渲染所有页面
- **增量静态生成**：支持发布新文章时的增量页面生成
- **图片优化**：使用Next.js Image组件优化图片加载
- **代码分割**：按页面和组件进行代码分割
- **懒加载**：非首屏内容和大型资源采用懒加载策略
- **缓存策略**：合理设置缓存头，减少重复请求

## 6. 数据需求

### 6.1 博客文章数据模型

**数据表**：BlogPost
**必需字段**：
- id：文章唯一标识符
- title：文章标题
- slug：URL友好的标识
- excerpt：文章摘要
- content：文章内容（Markdown格式）
- coverImage：封面图URL
- publishedAt：发布日期
- updatedAt：更新日期
- author：作者信息（可嵌套对象）
- categories：所属分类（数组）
- tags：文章标签（数组）
- featured：是否推荐/置顶（布尔值）
- status：文章状态（发布、草稿）
- readingTime：预估阅读时间
- viewCount：浏览次数
- likeCount：点赞数
- toc：自动生成的目录结构（对象数组）
- relatedPosts：相关文章ID（数组）
- seo：SEO相关信息（嵌套对象）
- contentType：内容类型（文章、教程、笔记等）

### 6.2 分类数据模型

**数据表**：Category
**必需字段**：
- id：分类唯一标识符
- name：分类名称
- slug：URL友好的标识
- description：分类描述
- parentId：父分类ID（如适用）
- image：分类图片URL（可选）
- order：排序权重
- count：该分类下的文章数量

### 6.3 标签数据模型

**数据表**：Tag
**必需字段**：
- id：标签唯一标识符
- name：标签名称
- slug：URL友好的标识
- description：标签描述（可选）
- count：使用该标签的文章数量
- color：标签显示颜色（可选）

### 6.4 评论数据模型

**数据表**：Comment
**必需字段**：
- id：评论唯一标识符
- postId：关联的文章ID
- author：评论者信息（名称、邮箱、网站等）
- content：评论内容
- createdAt：创建时间
- parentId：父评论ID（用于回复功能）
- status：评论状态（已审核、待审核、垃圾评论）
- likes：点赞数

### 6.5 数据关系

- **文章-分类**：多对多关系，一篇文章可属于多个分类
- **文章-标签**：多对多关系，一篇文章可有多个标签
- **分类-子分类**：一对多关系，实现分类层次结构
- **文章-评论**：一对多关系，一篇文章可有多条评论
- **评论-回复**：自引用关系，评论可有多个回复

### 6.6 数据源和更新

- **存储方式**：文章内容存储为Markdown文件，元数据通过frontmatter定义
- **文件结构**：
  ```
  /content/blog/
    category-1/
      article-1.md
      article-2.md
    category-2/
      article-3.md
  ```
- **更新方式**：通过Git提交更新文章，触发网站重新构建
- **图片存储**：文章图片存储在`/public/images/blog/`目录，按文章或分类组织

## 7. 非功能性需求

### 7.1 性能指标

- 博客首页加载时间：< 2秒
- 文章详情页完全加载时间：< 3秒
- 首次内容绘制(FCP)：< 1.5秒
- 大型内容加载策略：优先加载可视区域内容，异步加载其余部分
- 页面切换响应时间：< 300ms
- Google Lighthouse性能评分：≥ 90分

### 7.2 SEO要求

- 每篇文章有唯一、描述性的标题和meta描述
- 使用语义化HTML结构，合理使用h1-h6标签
- 图片添加alt属性，提高可访问性和SEO表现
- 实现结构化数据（Schema.org ArticleSchema）
- 自动生成sitemap.xml和RSS feed
- 支持规范化URL（canonical URL）
- 实现Open Graph和Twitter Cards，优化社交媒体分享

### 7.3 可访问性要求

- 符合WCAG 2.1 AA级标准
- 键盘导航支持（焦点可见性、逻辑Tab顺序）
- 屏幕阅读器支持，使用合适的ARIA属性
- 颜色对比度符合AA标准
- 文字大小可调整，不使用固定像素大小
- 动画提供暂停选项，避免引起不适

### 7.4 国际化支持

- 支持多语言内容（可选，初期可仅支持中文）
- 日期和时间格式本地化
- 考虑特殊字符和非拉丁文字的显示
- RTL（从右到左）语言支持（如阿拉伯语，可选）

### 7.5 安全性要求

- 评论系统防止垃圾评论和XSS攻击
- 敏感操作（如点赞、评论）添加适当的速率限制
- 所有用户输入进行严格验证和过滤
- 使用HTTPS确保内容传输安全

## 8. 设计规范

### 8.1 布局设计

- **首页布局**：
  - 桌面端：两栏或三栏布局，主内容区+侧边栏
  - 平板端：动态调整为两栏或单栏布局
  - 移动端：单栏布局，菜单折叠为汉堡按钮
- **文章页布局**：
  - 桌面端：主内容+侧边目录导航
  - 移动端：单栏内容，目录可通过按钮展开
- **内容宽度**：
  - 文章阅读区最大宽度：720px（确保舒适阅读）
  - 整体内容区最大宽度：1200px

### 8.2 排版规范

- **字体系统**：
  - 标题：网站主标题字体
  - 正文：易读的无衬线字体
  - 代码：等宽字体，与主题兼容
- **字体大小**：
  - 文章标题：32px/24px（桌面/移动）
  - 文章小标题：24px/20px，20px/18px
  - 正文：18px/16px
  - 元数据、注释：14px/12px
- **行高和间距**：
  - 正文行高：1.7-1.8
  - 段落间距：1.5em
  - 标题下间距：0.8em
  - 代码块外边距：2em 0

### 8.3 阅读体验设计

- **正文设计**：
  - 段落宽度：确保每行60-75个字符
  - 文本对比度：符合WCAG AA标准
  - 段落缩进：不使用首行缩进，段落间使用间距分隔
- **链接样式**：
  - 正文链接：下划线或颜色区分，悬停效果明确
  - 导航链接：无下划线，使用颜色和位置表明导航性质
- **代码显示**：
  - 行内代码：轻微背景色区分，等宽字体
  - 代码块：语法高亮，行号显示，复制按钮
  - 代码字体大小：16px/14px，确保可读性

### 8.4 交互设计

- **状态反馈**：
  - 链接悬停：颜色变化或轻微动画
  - 按钮状态：正常、悬停、点击状态视觉差异
  - 加载状态：适当的加载指示器
- **动画效果**：
  - 页面转场：轻微淡入淡出（200-300ms）
  - 元素进入：渐进式显示（staggered animation）
  - 交互反馈：简洁、流畅的微动效

## 9. 验收标准

1. 博客首页成功加载并显示最新文章列表，支持分类和标签筛选
2. 文章详情页正确渲染Markdown内容，包括代码高亮、图片和嵌入内容
3. 文章目录自动生成并支持锚点导航
4. 分类和标签页面正确显示对应的文章列表
5. 搜索功能能够准确查找相关文章
6. 响应式布局在各种设备上正确显示
7. 评论功能工作正常，支持基本的嵌套回复
8. SEO元素完整，通过Lighthouse SEO检查
9. 页面性能达到设定的指标要求
10. 内容更新机制工作正常，新文章能够正确显示

## 10. 附录

### 10.1 Markdown支持功能列表

- **基础格式**：
  - 标题（h1-h6）
  - 段落、换行
  - 强调（粗体、斜体）
  - 列表（有序、无序、任务列表）
  - 链接（内部链接、外部链接）
  - 图片（支持alt文本和标题）
  - 引用块
  - 水平分割线

- **扩展功能**：
  - 代码块（支持多种语言语法高亮）
  - 表格
  - 脚注
  - 定义列表
  - 删除线
  - 自定义容器（提示、警告、信息框）
  - 数学公式（KaTeX或MathJax）
  - 流程图和图表（Mermaid）
  - 嵌入内容（YouTube视频、Twitter帖子等）

### 10.2 文章frontmatter示例

```yaml
---
title: "使用React Hooks构建高性能Web应用"
slug: "building-high-performance-web-apps-with-react-hooks"
excerpt: "深入探讨如何利用React Hooks优化应用性能，减少不必要的渲染并提高用户体验。"
coverImage: "/images/blog/react-hooks-performance/cover.webp"
publishedAt: "2023-09-15T10:00:00Z"
updatedAt: "2023-09-20T14:30:00Z"
author:
  name: "张三"
  avatar: "/images/avatars/zhangsan.jpg"
categories: ["前端开发", "React", "性能优化"]
tags: ["React", "Hooks", "性能优化", "Web开发", "JavaScript"]
featured: true
status: "published"
contentType: "tutorial"
seo:
  title: "React Hooks性能优化完全指南 - 打造丝滑用户体验"
  description: "学习如何使用React Hooks中的useMemo、useCallback和自定义hooks优化React应用性能，避免常见的性能陷阱。"
  keywords: "React性能优化, Hooks优化, useMemo, useCallback, 前端性能"
---
```

### 10.3 文章目录结构示例

```json
[
  {
    "id": "introduction",
    "text": "引言",
    "level": 2
  },
  {
    "id": "common-performance-issues",
    "text": "常见的React性能问题",
    "level": 2,
    "children": [
      {
        "id": "unnecessary-renders",
        "text": "不必要的组件重渲染",
        "level": 3
      },
      {
        "id": "expensive-calculations",
        "text": "昂贵的计算操作",
        "level": 3
      }
    ]
  },
  {
    "id": "optimization-with-hooks",
    "text": "使用Hooks优化性能",
    "level": 2,
    "children": [
      {
        "id": "usememo-hook",
        "text": "使用useMemo缓存计算结果",
        "level": 3
      },
      {
        "id": "usecallback-hook",
        "text": "使用useCallback优化事件处理函数",
        "level": 3
      },
      {
        "id": "custom-hooks",
        "text": "创建性能优化相关的自定义Hooks",
        "level": 3
      }
    ]
  }
]
```

### 10.4 评论系统选项

1. **自建评论系统**：
   - 优点：完全控制数据和UI，无外部依赖
   - 缺点：需要自行实现垃圾评论过滤，额外的服务器负载
   - 技术选择：Next.js API routes + 数据库存储

2. **第三方评论服务**：
   - Disqus：功能全面，社交集成，但加载较慢
   - Commento：轻量级，注重隐私
   - Utterances：基于GitHub Issues，适合技术博客
   - Giscus：基于GitHub Discussions，现代化选择

3. **静态站点评论解决方案**：
   - 使用无服务器函数处理评论提交
   - 评论存储在GitHub仓库中
   - 站点重新构建以显示新评论

### 10.5 博客文章类型示例

1. **技术教程**：详细的步骤指南，包含代码示例和解释
2. **概念解析**：深入剖析技术概念、原理和设计思想
3. **项目分析**：分析特定项目的实现，讨论技术选择和架构
4. **问题解决**：针对特定技术问题的解决方案和思路
5. **技术评测**：对框架、库或工具的评测和比较
6. **行业趋势**：技术方向和行业发展的分析文章
7. **学习笔记**：学习过程中的笔记和心得
8. **代码片段**：实用代码片段集合及其使用场景
9. **经验分享**：个人技术经验和项目经验的分享
10. **读书笔记**：技术书籍阅读笔记和重点摘要

## 11. 实现状态

### 11.1 已实现功能

- **博客列表页面**：
  - ✅ 文章卡片展示（标题、摘要、发布日期、阅读时间、分类、标签等信息）
  - ✅ 分类和标签筛选功能
  - ✅ 搜索功能
  - ✅ 搜索历史记录功能
  - ✅ 视图切换（网格/列表视图）
  - ✅ 精选文章标记

- **分类页面**：
  - ✅ 分类头部信息展示
  - ✅ 该分类下的文章列表
  - ✅ 筛选和搜索功能

- **标签页面**：
  - ✅ 标签相关文章展示
  - ✅ 返回导航

- **全部文章页面**：
  - ✅ 显示所有博客文章
  - ✅ 支持筛选和搜索功能

- **组件实现**：
  - ✅ 博客文章卡片组件（BlogPostCard）
  - ✅ 文章列表组件（BlogList）
  - ✅ 博客筛选器组件（BlogFilter）
  - ✅ 搜索框组件（SearchBox）
  - ✅ 搜索历史组件（SearchHistory）
  - ✅ Markdown内容渲染组件（MarkdownContent）
  - ✅ 文章目录组件（TableOfContents）

- **数据服务**：
  - ✅ 文章数据模型定义
  - ✅ 分类和标签数据模型定义
  - ✅ 获取文章列表、按分类获取、按标签获取等功能

### 11.2 待实现功能

- **文章详情页面**：
  - ❌ 完整文章展示
  - ❌ 文章目录导航
  - ❌ 相关文章推荐
  - ❌ 评论系统
  - ❌ 点赞功能
  - ❌ 分享功能

- **归档页面**：
  - ❌ 时间轴展示
  - ❌ 按年月归档

- **其他功能**：
  - ❌ 评论管理
  - ❌ RSS Feed
  - ❌ 文章阅读进度指示器
  - ❌ 草稿预览功能

### 11.3 已知问题

1. 图片资源加载失败 - Unsplash图片加载404错误问题需解决
2. 移动端适配需优化 - 特别是在小屏幕设备上的布局和交互体验
3. SEO优化不完全 - 需要完善元标签和结构化数据
4. 文章详情页路由参数处理问题 - 出现"Route '/blog/[slug]' used `params.slug`. `params` should be awaited before using its properties"错误
5. 构建过程中出现Radix UI的vendor chunk错误

## 12. 验收标准

1. 博客首页成功加载并显示最新文章列表，支持分类和标签筛选
2. 文章详情页正确渲染Markdown内容，包括代码高亮、图片和嵌入内容
3. 文章目录自动生成并支持锚点导航
4. 分类和标签页面正确显示对应的文章列表
5. 搜索功能能够准确查找相关文章
6. 响应式布局在各种设备上正确显示
7. 评论功能工作正常，支持基本的嵌套回复
8. SEO元素完整，通过Lighthouse SEO检查
9. 页面性能达到设定的指标要求
10. 内容更新机制工作正常，新文章能够正确显示 